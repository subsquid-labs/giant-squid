type Account @entity {
  id: ID!
  transfers: [AccountTransfer!] @derivedFrom(field: "account")
  xcmTransfers: [XcmTransfer!] @derivedFrom(field: "from")
  lastUpdateBlock: BigInt!
}

enum TransferDirection {
  FROM
  TO
}

interface Action {
  timestamp: DateTime
  blockNumber: BigInt
  extrinsicHash: String
  amount: BigInt
}

interface CanFail {
  success: Boolean
}

type Transfer implements Action & CanFail @entity {
  id: ID!
  timestamp: DateTime
  blockNumber: BigInt
  extrinsicHash: String @index
  toId: ID
  to: Account
  fromId: ID
  from: Account
  amount: BigInt
  success: Boolean @index
}

type AccountTransfer @entity {
  id: ID!
  transfer: Transfer
  account: Account!
  direction: TransferDirection
}

type XcmTransfer implements CanFail @entity {
  id: ID!
  timestamp: DateTime
  blockNumber: BigInt @index
  extrinsicHash: String @index
  fromId: ID!
  from: Account!
  to: XcmDestination!
  assets: [XcmAsset]!
  success: Boolean @index
}

type XcmDestination {
  id: String
  paraId: Int
}

type XcmAsset {
  amount: BigInt
  token: String
}